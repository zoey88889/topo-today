<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ TOPO TODAY | æ–‡åŒ– Â· åŸå¸‚è®°å¿†</title>
  <link rel="stylesheet" href="styles/styles.css" />

  <!-- SEO canonical -->
  <link rel="canonical" href="https://topo.today/culture.html">
</head>

<body>

  <!-- é¡µå¤´ -->
  <header class="hero">
    <h1>ğŸ TOPO æ–‡åŒ– Â· åŸå¸‚è®°å¿†</h1>
    <p>åäººæ–‡åŒ–èŠ‚ï½œçº½çº¦æ•…äº‹ï½œæœ¬åœ°è‰ºæœ¯ç”Ÿæ´»ï½œå†å²ä¸å›å¿†</p >
  </header>

  <!-- æŠ•ç¨¿å…¥å£ -->
  <div style="text-align:center; margin-top:1rem;">
    <a href=" " style="padding:0.6rem 1.2rem; background:#3f51b5; color:#fff; border-radius:8px; text-decoration:none;">
      ğŸ“ æˆ‘è¦æŠ•ç¨¿
    </a >
  </div>

  <!-- Supabase åŠ¨æ€æ¸²æŸ“åŒº -->
  <section class="modules" id="postContainer" style="margin-top:2rem;"></section>

  <!-- RSS è‡ªåŠ¨æ‹‰å–å±•ç¤ºåŒº -->
  <section class="modules" id="rssContainer" style="margin-top:2rem;"></section>

  <!-- å†…åµŒè„šæœ¬ï¼šæ‹‰å–æ–‡åŒ– RSS -->
  <script>
    async function fetchCultureRSS() {
      const rssSources = [
        "https://www.si.edu/rss",                                        // Smithsonian Institution
        "https://www.metmuseum.org/rss",                                 // The Met Museum
        "https://www.chinainstitute.org/feed/",                           // China Institute NYC
        "https://www.nyc.gov/html/dcla/html/about/rss.shtml"              // NYC Cultural Affairs
      ];

      const container = document.getElementById("rssContainer");
      container.innerHTML = "";

      for (const rssUrl of rssSources) {
        try {
          const proxyUrl = "https://api.allorigins.win/get?url=" + encodeURIComponent(rssUrl);
          const res = await fetch(proxyUrl);
          const text = await res.json();
          const parser = new DOMParser();
          const xml = parser.parseFromString(text.contents, "text/xml");
          const items = xml.querySelectorAll("item");

          items.forEach((item, index) => {
            if (index > 2) return; // æ¯ä¸ª RSS æœ€å¤šæ˜¾ç¤º 3 æ¡

            const title = item.querySelector("title")?.textContent || "æ— æ ‡é¢˜";
            const desc = item.querySelector("description")?.textContent || "";
            const link = item.querySelector("link")?.textContent || "#";

            const card = document.createElement("div");
            card.className = "card";
            card.style = `
              background: #fff;
              border-left: 6px solid #3f51b5;
              padding: 1rem;
              margin-bottom: 1rem;
              border-radius: 8px;
            `;
            card.innerHTML = `
              <h3 style="margin-bottom:0.5rem;">ğŸ ${title}</h3>
              <p style="font-size:0.9rem;">${desc}</p >
              <a href="${link}" target="_blank" style="font-size:0.85rem; color:#3f51b5;">ğŸ”— é˜…è¯»åŸæ–‡</a >
            `;
            container.appendChild(card);
          });
        } catch (err) {
          console.warn("âŒ RSS è¯»å–å¤±è´¥ï¼š", rssUrl, err);
        }
      }
    }

    fetchCultureRSS();
  </script>

  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="scripts/supabase.js"></script>       <!-- supabase åˆå§‹åŒ– -->
  <script src="scripts/topo.init.js"></script>      <!-- ç™»å½•/ç™»å‡º -->
  <script src="scripts/post-display.js"></script>   <!-- æ¸²æŸ“ supabase å†…å®¹ -->

  <!-- é¡µè„š -->
  <div id="footer"></div>
  <script>
    fetch("/components/footer.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("footer").innerHTML = html;
      });
  </script>

</body>
</html>